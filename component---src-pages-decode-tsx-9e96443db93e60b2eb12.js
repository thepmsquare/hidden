"use strict";(self.webpackChunkhidden=self.webpackChunkhidden||[]).push([[877],{6728:function(e,t,a){a.r(t),a.d(t,{Head:function(){return S}});var n=a(7294),s=a(4160),r=a(5295),l=a(245),c=a(2574),m=a(9617),o=a(9164),d=a(1354),i=a.n(d),g=a(5991),p=a(8879),u=a(5677),h=a(7063),I=a(6693),w=a(1023),f=a(2143),y=a(4712);const E="undefined"!=typeof window,S=()=>n.createElement("title",null,"decode | hidden");t.default=e=>{let t;if(!(a=e.location.state)||null===a||!("selectedImageState"in a))return E&&(0,s.c4)("/"),"";var a;let d,S;t={selectedImage:e.location.state.selectedImageState.selectedImage,selectedImageName:e.location.state.selectedImageState.selectedImageName,selectedImageType:e.location.state.selectedImageState.selectedImageType,selectedImageURL:URL.createObjectURL(e.location.state.selectedImageState.selectedImage)},d=E?window.localStorage.getItem("theme"):null,null!==d?S="dark"===d?"dark":"light":(S=g.Z.defaultThemeState,E&&window.localStorage.setItem("theme",g.Z.defaultThemeState));const{0:v,1:b}=(0,n.useState)(S),{0:Z,1:N}=(0,n.useState)({isOpen:!1,message:"",severity:"error"}),{0:k,1:T}=(0,n.useState)(t),{0:L,1:C}=(0,n.useState)(""),A=(e,t,a)=>{let n="";for(let s=0;s<e;s++)n+=t.data[4*a[0]+a[1]].toString(2).padStart(8,"0").slice(6),2===a[1]?(a[1]=0,a[0]=a[0]+1):a[1]=a[1]+1;return n};let F=(0,m.Z)({palette:{mode:v},typography:{fontFamily:g.Z.defaultFont}});return n.createElement(o.Z,{theme:F},n.createElement("main",{className:"main",style:{backgroundImage:'url("'+k.selectedImageURL+'")'}},n.createElement(r.Z,{className:"inside-main"},n.createElement(l.Z,null,"selected image:"," ",n.createElement(l.Z,{title:k.selectedImageName+"."+(null==k?void 0:k.selectedImageType),color:"primary",variant:"button"},k.selectedImageName.length>g.Z.step2FileNameLength.max?k.selectedImageName.slice(0,g.Z.step2FileNameLength.visibleEnds)+"..."+k.selectedImageName.slice(-g.Z.step2FileNameLength.visibleEnds)+"."+k.selectedImageType:k.selectedImageName+"."+k.selectedImageType)),n.createElement("form",{className:"form",onSubmit:async e=>{e.preventDefault();try{const e=new Image;e.src=k.selectedImageURL;const a=document.createElement("canvas");a.width=e.width,a.height=e.height;const n=a.getContext("2d",{colorSpace:"srgb"});if(null===n)throw Error("unexpected error.");n.drawImage(e,0,0);let r,l=(e=>{const t=[];let a=[0,0];for(;;){let n=A(1,e,a);if("0"===n.charAt(0))t.push(n+A(3,e,a));else{if(n===g.Z.messageAppendedAtEnd)break;if(n+=A(1,e,a),"110"===n.substring(0,3)){let s=n.substring(3)+A(2,e,a);if("10"!==A(1,e,a))throw new Error("Input image doesn't appear to have any encoded message.");s+=A(3,e,a),t.push(s)}else if("1110"===n){let n=A(2,e,a);if("10"!==A(1,e,a))throw new Error("Input image doesn't appear to have any encoded message.");if(n+=A(3,e,a),"10"!==A(1,e,a))throw new Error("Input image doesn't appear to have any encoded message.");n+=A(3,e,a),t.push(n)}else{if("11110"!==n.substring(0,5))throw new Error("Input image doesn't appear to have any encoded message.");{let s=n.substring(5)+A(1,e,a);if("10"!==A(1,e,a))throw new Error("Input image doesn't appear to have any encoded message.");if(s+=A(3,e,a),"10"!==A(1,e,a))throw new Error("Input image doesn't appear to have any encoded message.");if(s+=A(3,e,a),"10"!==A(1,e,a))throw new Error("Input image doesn't appear to have any encoded message.");s+=A(3,e,a),t.push(s)}}}}return t})(n.getImageData(0,0,a.width,a.height)),c=l.map((e=>String.fromCharCode(parseInt(e,2)))).join("");if(L){try{r=i().AES.decrypt(c,L).toString(i().enc.Utf8)}catch(t){throw new Error("Wrong Password.")}if(""===r)throw new Error("Wrong Password.")}else if(r=c,""===r)throw new Error("Input image doesn't appear to have any encoded message.");await(0,s.c4)("/decode_share/",{state:{selectedImageState:{selectedImage:k.selectedImage,selectedImageName:k.selectedImageName,selectedImageType:k.selectedImageType},finalMessage:r}})}catch(t){N({isOpen:!0,message:t.message,severity:"error"})}}},n.createElement(f.Z,{value:L,onChange:e=>C(e.target.value),others:{autoFocus:!0},uniqueIdForARIA:"decode-password",variant:"outlined",label:"optional password"}),n.createElement(c.Z,{type:"submit",color:"primary",variant:"contained",size:"large"},"submit")),n.createElement(c.Z,{onClick:()=>{let e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/png"),e.addEventListener("change",(e=>{(0,h.Z)(e,((e,t,a)=>{T({selectedImage:(0,y.Z)(e),selectedImageName:t,selectedImageType:a,selectedImageURL:e})}),N)})),e.click()},variant:"outlined",startIcon:n.createElement(I.Z,null)},"change selected image"),n.createElement(p.Z,{themeState:v,customChangeThemeState:e=>{b(e),E&&window.localStorage.setItem("theme",e)}}),n.createElement(c.Z,{onClick:async()=>{await(0,s.c4)("/step2/",{state:{selectedImageState:{selectedImage:k.selectedImage,selectedImageName:k.selectedImageName,selectedImageType:k.selectedImageType}}})},variant:"outlined",size:"small",startIcon:n.createElement(w.Z,null)},"go back")),n.createElement(u.Z,{snackbarState:Z,changeSnackbarState:N})))}}}]);
//# sourceMappingURL=component---src-pages-decode-tsx-9e96443db93e60b2eb12.js.map