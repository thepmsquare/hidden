"use strict";(self.webpackChunkhidden=self.webpackChunkhidden||[]).push([[487],{9780:function(e,t,a){a.r(t),a.d(t,{Head:function(){return v}});var n=a(7294),l=a(4854),r=a(5295),s=a(245),i=a(7129),c=a(2574),o=a(9617),m=a(9164),g=a(1354),d=a.n(g),h=a(5991),u=a(8879),p=a(5677),S=a(7063),I=a(6693),w=a(1023),E=a(2143);const f="undefined"!=typeof window,v=()=>n.createElement("title",null,"encode | hidden");t.default=e=>{let t;if(!(a=e.location.state)||null===a||!("selectedImageState"in a))return f&&(0,l.navigate)("/"),"";var a;let g,v;t=e.location.state.selectedImageState,g=f?window.localStorage.getItem("theme"):null,null!==g?v="dark"===g?"dark":"light":(v=h.Z.defaultThemeState,f&&window.localStorage.setItem("theme",h.Z.defaultThemeState));const{0:Z,1:y}=(0,n.useState)(v),{0:b,1:k}=(0,n.useState)({isOpen:!1,message:"",severity:"error"}),{0:N,1:C}=(0,n.useState)(t),{0:x,1:A}=(0,n.useState)(""),{0:T,1:F}=(0,n.useState)(""),D=e=>{let t="",a="";try{for(let n=0;n<e.length;n++){const l=e.charCodeAt(n);let r=l.toString(2);if(a="",l<128)a=r.padStart(8,"0");else if(l<2048)r=r.padStart(11,"0"),a="110"+r.slice(0,5)+"10"+r.slice(5,12);else if(l<65536)r=r.padStart(16,"0"),a="1110"+r.slice(0,4)+"10"+r.slice(4,10)+"10"+r.slice(10,16);else{if(!(l<=1114111))throw new Error;r=r.padStart(21,"0"),a="11110"+r.slice(0,3)+"10"+r.slice(3,9)+"10"+r.slice(9,15)+"10"+r.slice(15,21)}t+=a}return t}catch(n){throw new Error("Unexpected error while processing the message text.")}};let L=(0,o.Z)({palette:{mode:Z},typography:{fontFamily:h.Z.defaultFont}});return n.createElement(m.Z,{theme:L},n.createElement("main",{className:"main",style:{backgroundImage:'url("'+(null==N?void 0:N.selectedImage)+'")'}},n.createElement(r.Z,{className:"inside-main"},n.createElement(s.Z,null,"selected image:"," ",n.createElement(s.Z,{title:N.selectedImageName+"."+(null==N?void 0:N.selectedImageType),color:"primary",variant:"button"},N.selectedImageName.length>h.Z.step2FileNameLength.max?N.selectedImageName.slice(0,h.Z.step2FileNameLength.visibleEnds)+"..."+N.selectedImageName.slice(-h.Z.step2FileNameLength.visibleEnds)+"."+N.selectedImageType:N.selectedImageName+"."+N.selectedImageType)),n.createElement("form",{className:"form",onSubmit:async e=>{e.preventDefault();try{const e=new Image;e.src=N.selectedImage;const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const a=t.getContext("2d",{colorSpace:"srgb"});if(null===a)throw Error("unexpected error.");let n;a.drawImage(e,0,0),n=D(T?d().AES.encrypt(x,T).toString():x);const r=a.getImageData(0,0,t.width,t.height);let s,i,c=new ImageData(t.width,t.height);[c,s,i]=((e,t,a,n,l)=>{let r=e.data,s=l.data,i=t+h.Z.messageAppendedAtEnd,c=i.length,o=a*n*3*2;if(c>o)throw new Error("Image with more pixels needed for encoding current message.");let m=Math.ceil(c/6),g=m/o*100,d=0;for(let h=0;h<i.length;h+=6){const e=i.slice(h,h+2),t=i.slice(h+2,h+4),a=i.slice(h+4,h+6);let n=parseInt(s[d].toString(),10).toString(2).padStart(8,"0").slice(0,6)+e,l=""!==t?parseInt(s[d+1].toString(),10).toString(2).padStart(8,"0").slice(0,6)+t:s[d+1].toString(),c=""!==a?parseInt(s[d+2].toString(),10).toString(2).padStart(8,"0").slice(0,6)+a:s[d+2].toString(),o=parseInt(n,2),m=parseInt(l,2),g=parseInt(c,2);r[d]=o,r[d+1]=m,r[d+2]=g,r[d+3]=s[d+3],d+=4}for(;d<s.length;d++)r[d]=s[d];return[e,m,g]})(c,n,e.width,e.height,r),a.putImageData(c,0,0);const o=t.toDataURL("image/png");await(0,l.navigate)("/encode_share/",{state:{selectedImageState:N,newDataURL:o,numPixelsToChange:s,percentImageChange:i}})}catch(t){k({isOpen:!0,message:t.message,severity:"error"})}}},n.createElement(i.Z,{placeholder:"enter text to hide in selected image",value:x,onChange:e=>A(e.target.value),required:!0,rows:3,multiline:!0,autoFocus:!0,label:"message"}),n.createElement(E.Z,{value:T,onChange:e=>F(e.target.value),uniqueIdForARIA:"encode-password",variant:"outlined",label:"optional password",others:{}}),n.createElement(c.Z,{type:"submit",size:"large",variant:"contained"},"submit")),n.createElement(c.Z,{onClick:()=>{let e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/png,image/jpeg,image/webp"),e.addEventListener("change",(e=>{(0,S.Z)(e,((e,t,a)=>{C({selectedImage:e,selectedImageName:t,selectedImageType:a})}),k)})),e.click()},variant:"outlined",startIcon:n.createElement(I.Z,null)},"change selected image"),n.createElement(u.Z,{themeState:Z,customChangeThemeState:e=>{y(e),f&&window.localStorage.setItem("theme",e)}}),n.createElement(c.Z,{onClick:async()=>{await(0,l.navigate)("/step2/",{state:{selectedImageState:N}})},variant:"outlined",size:"small",startIcon:n.createElement(w.Z,null)},"go back")),n.createElement(p.Z,{snackbarState:b,changeSnackbarState:k})))}}}]);
//# sourceMappingURL=component---src-pages-encode-tsx-5d684783ba67d1981ffa.js.map