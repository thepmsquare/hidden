"use strict";(self.webpackChunkhidden=self.webpackChunkhidden||[]).push([[487],{9780:function(e,t,a){a.r(t),a.d(t,{Head:function(){return y}});var l=a(7294),n=a(4160),s=a(5295),c=a(245),r=a(7129),i=a(2574),m=a(9617),g=a(9164),o=a(1354),d=a.n(o),h=a(5991),u=a(8879),p=a(5677),I=a(7063),S=a(4712),w=a(6693),E=a(1023),f=a(2143);const Z="undefined"!=typeof window,y=()=>l.createElement("title",null,"encode | hidden");t.default=e=>{let t;if(!(a=e.location.state)||null===a||!("selectedImageState"in a))return Z&&(0,n.c4)("/"),"";var a;let o,y;t={selectedImage:e.location.state.selectedImageState.selectedImage,selectedImageName:e.location.state.selectedImageState.selectedImageName,selectedImageType:e.location.state.selectedImageState.selectedImageType,selectedImageURL:URL.createObjectURL(e.location.state.selectedImageState.selectedImage)},o=Z?window.localStorage.getItem("theme"):null,null!==o?y="dark"===o?"dark":"light":(y=h.Z.defaultThemeState,Z&&window.localStorage.setItem("theme",h.Z.defaultThemeState));const{0:b,1:v}=(0,l.useState)(y),{0:N,1:k}=(0,l.useState)({isOpen:!1,message:"",severity:"error"}),{0:T,1:C}=(0,l.useState)(t),{0:L,1:x}=(0,l.useState)(""),{0:A,1:R}=(0,l.useState)(""),U=e=>{let t="",a="";try{for(let l=0;l<e.length;l++){const n=e.charCodeAt(l);let s=n.toString(2);if(a="",n<128)a=s.padStart(8,"0");else if(n<2048)s=s.padStart(11,"0"),a="110"+s.slice(0,5)+"10"+s.slice(5,12);else if(n<65536)s=s.padStart(16,"0"),a="1110"+s.slice(0,4)+"10"+s.slice(4,10)+"10"+s.slice(10,16);else{if(!(n<=1114111))throw new Error;s=s.padStart(21,"0"),a="11110"+s.slice(0,3)+"10"+s.slice(3,9)+"10"+s.slice(9,15)+"10"+s.slice(15,21)}t+=a}return t}catch(l){throw new Error("Unexpected error while processing the message text.")}};let F=(0,m.Z)({palette:{mode:b},typography:{fontFamily:h.Z.defaultFont}});return l.createElement(g.Z,{theme:F},l.createElement("main",{className:"main",style:{backgroundImage:'url("'+T.selectedImageURL+'")'}},l.createElement(s.Z,{className:"inside-main"},l.createElement(c.Z,null,"selected image:"," ",l.createElement(c.Z,{title:T.selectedImageName+"."+(null==T?void 0:T.selectedImageType),color:"primary",variant:"button"},T.selectedImageName.length>h.Z.step2FileNameLength.max?T.selectedImageName.slice(0,h.Z.step2FileNameLength.visibleEnds)+"..."+T.selectedImageName.slice(-h.Z.step2FileNameLength.visibleEnds)+"."+T.selectedImageType:T.selectedImageName+"."+T.selectedImageType)),l.createElement("form",{className:"form",onSubmit:async e=>{e.preventDefault();try{const e=new Image;e.src=T.selectedImageURL;const t=document.createElement("canvas");t.width=e.width,t.height=e.height;const a=t.getContext("2d",{colorSpace:"srgb"});if(null===a)throw Error("unexpected error.");let l;a.drawImage(e,0,0),l=U(A?d().AES.encrypt(L,A).toString():L);const s=a.getImageData(0,0,t.width,t.height);let c,r,i=new ImageData(t.width,t.height);[i,c,r]=((e,t,a,l,n)=>{let s=e.data,c=n.data,r=t+h.Z.messageAppendedAtEnd,i=r.length;if(i>a*l*3*2)throw new Error("Image with more pixels needed for encoding current message.");let m=Math.ceil(i/6),g=m/(a*l)*100,o=0;for(let d=0;d<r.length;d+=6){const e=r.slice(d,d+2),t=r.slice(d+2,d+4),a=r.slice(d+4,d+6);let l=parseInt(c[o].toString(),10).toString(2).padStart(8,"0").slice(0,6)+e,n=""!==t?parseInt(c[o+1].toString(),10).toString(2).padStart(8,"0").slice(0,6)+t:c[o+1].toString(),i=""!==a?parseInt(c[o+2].toString(),10).toString(2).padStart(8,"0").slice(0,6)+a:c[o+2].toString(),m=parseInt(l,2),g=parseInt(n,2),h=parseInt(i,2);s[o]=m,s[o+1]=g,s[o+2]=h,s[o+3]=c[o+3],o+=4}for(;o<c.length;o++)s[o]=c[o];return[e,m,g]})(i,l,e.width,e.height,s),a.putImageData(i,0,0);const m=t.toDataURL("image/png");await(0,n.c4)("/encode_share/",{state:{selectedImageName:T.selectedImageName,newDataBlob:(0,S.Z)(m),numPixelsToChange:c,percentImageChange:r}})}catch(t){k({isOpen:!0,message:t.message,severity:"error"})}}},l.createElement(r.Z,{placeholder:"enter text to hide in selected image",value:L,onChange:e=>x(e.target.value),required:!0,rows:3,multiline:!0,autoFocus:!0,label:"message"}),l.createElement(f.Z,{value:A,onChange:e=>R(e.target.value),uniqueIdForARIA:"encode-password",variant:"outlined",label:"optional password",others:{}}),l.createElement(i.Z,{type:"submit",size:"large",variant:"contained"},"submit")),l.createElement(i.Z,{onClick:()=>{let e=document.createElement("input");e.setAttribute("type","file"),e.setAttribute("accept","image/png,image/jpeg,image/webp"),e.addEventListener("change",(e=>{(0,I.Z)(e,((e,t,a)=>{C({selectedImage:(0,S.Z)(e),selectedImageName:t,selectedImageType:a,selectedImageURL:e})}),k)})),e.click()},variant:"outlined",startIcon:l.createElement(w.Z,null)},"change selected image"),l.createElement(u.Z,{themeState:b,customChangeThemeState:e=>{v(e),Z&&window.localStorage.setItem("theme",e)}}),l.createElement(i.Z,{onClick:async()=>{await(0,n.c4)("/step2/",{state:{selectedImageState:{selectedImage:T.selectedImage,selectedImageName:T.selectedImageName,selectedImageType:T.selectedImageType}}})},variant:"outlined",size:"small",startIcon:l.createElement(E.Z,null)},"go back")),l.createElement(p.Z,{snackbarState:N,changeSnackbarState:k})))}}}]);
//# sourceMappingURL=component---src-pages-encode-tsx-bd12419f3fad894ba411.js.map